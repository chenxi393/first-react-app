name: reacté¡¹ç›®éƒ¨ç½²è¿è¡ŒğŸ˜
on: 
  push:  # åœ¨pushçš„æ—¶å€™ åŠ¨ä½œ
    branches: ["master"]

permissions:
  contents: write # ç”¨äºå†™å…¥åˆ†æ”¯ éƒ¨ç½²åˆ°github page

jobs:
  build:
    name: npm-buildåˆ°github pageğŸ¤¦â€â™‚ï¸
    runs-on: ubuntu-latest
    
    steps:
    - name: è¯»å–ä»“åº“å†…å®¹ğŸ˜‰
      uses: actions/checkout@v4

    - name: å®‰è£…ä¾èµ–&é¡¹ç›®æ‰“åŒ…ğŸ¤¦â€â™€ï¸
      run: |
        npm install
        npm run build
    
    - name: éƒ¨ç½²åˆ°github pageğŸ˜‚
      uses: JamesIves/github-pages-deploy-action@v4
      with:
        branch: feat_pages
        folder: build

  build-image: # ä¸åŒçš„job æˆ‘ç†è§£æ˜¯å¹¶å‘çš„ run æ˜¯ä¸²è¡Œçš„
    runs-on: ubuntu-latest
    name: æ„å»ºé•œåƒğŸ˜’
    
    steps:
    - name: è¯»å–ä»“åº“å†…å®¹ğŸ˜‰
      uses: actions/checkout@v4

    - name: ç™»å½•DockerHubğŸ’•
      uses: docker/login-action@v3
      with:
        username: ${{ secrets.DOCKER_HUB_USERNAME }}
        password: ${{ secrets.DOCKER_HUB_PASSWORD }}
    
    - name: æ„å»ºå¹¶æ¨é€åˆ°docker hubâ¤ï¸
      uses: docker/build-push-action@v5
      with:
        push: true
        tags: chenxi393/react-app:latest

  deploy: # TODO éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š
    runs-on: ubuntu-latest
    name: éƒ¨ç½²åˆ°æœåŠ¡å™¨ğŸ¤£

    steps:
    - run: pwd